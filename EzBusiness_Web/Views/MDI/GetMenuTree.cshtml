@model List<EzBusiness_ViewModels.Models.MenuItem.MenuItemsVM>
@*Scripts.Render("~/bundles/jquery")*@
<script src="/Scripts/jquery-1.10.2.js"></script>

<style>
    /*Here We will add some css for style our treeview*/
     .collapse {
        width: 15px;
        background-image: url('../../Images/move-to-next.png');
        background-repeat: no-repeat;
        /*background-position: -36px -17px;*/
        display: inline-block;
        cursor: pointer;
    }

    .expand {
        width: 15px;
        background-image: url('../../Images/move-to-next.png');
        background-repeat: no-repeat;
        /*background-position: -50px -17px;*/
        display: inline-block;
        cursor: pointer;      
    }

    .treeview ul {
        font: 14px Arial, Sans-Serif;
        margin: 0px;
        padding-left: 10px;
        list-style: none;
    }

    .treeview > li > a {
        font-weight: bold;
        
    }
  
    .treeview li {
    }

        .treeview li a {
            padding: 4px;
            font-size: 14px;
            display: inline-block;
            text-decoration: none;
            width: auto;
            color: #4ECDC4;
        }
    
  
</style>


<div style="padding: 10px;background-color: #555b5d;margin-top: -70px;margin-bottom:20px;">

   
        <label for="nav-search" class="col-2 col-form-label sr-only">Search links</label>
        <div class="col p-2">
            <input class="form-control form-control-sm search-filter" type="search" id="nav-search" placeholder="Search for Menu">
        </div>
    

    <div class="treeview" id="link-content">   
             
        @if (Model != null && Model.Count() > 0)
        {
            <ul class="abc">
                @TreeviewMenu.GetTreeView(Model, Model.FirstOrDefault().ParentFormID)
            </ul>
        }
    </div>
</div>



<script>

    $(document).ready(function () {
        debugger;
        $(".treeview li>ul").css('display', 'none'); // Hide all 2-level ul

        $(".treeview > li > a").on("click", function(e)   {
            debugger;
            if ($(this).parent().has("ul")) {
                e.preventDefault();
            }

            if (!$(this).hasClass("open")) {
                // hide any open menus and remove all other classes
                $("#nav li ul").slideUp(350);
                $("#nav li a").removeClass("open");

                // open our new menu and add the open class
                $(this).next("ul").slideDown(350);
                $(this).addClass("open");
            } else if ($(this).hasClass("open")){
                $(this).removeClass("open");
                $(this).next("ul").slideUp(350);
            }
        $(".treeview > li:first > a").trigger('click');
    });

        $(".collapsible").click(function (e) {
            debugger;      
            e.preventDefault();
            var breadcrumb = [];
            var treeView = this;
            //data
            $(this).toggleClass("collapse expand");
            $(this).closest('li').children('ul').slideToggle();
            jQuery.expr[':'].casecontains = (a, b, c) => jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase()) >= 0;

            if ($('#search1').val() != '') {

                $('#search1').val('');

                $(".treeview li>ul").css('display', 'none');

                // secretly unhide the collapsed links

                $('#link-content li.nav-item ul').hide();
                // if search is empty, show the div and reset columns
                $('#link-content li').show();
              
                //$(".treeview li>ul").children('td').eq(1).show();
          
              //var secondCell = $(".treeview li>ul").children()[0];
            //  alert(secondCell.textContent);
                // $('#search1').val('');
              var pathname = document.location.pathname; 
              var url = pathname;
            
              var currentItem = $(".treeview").find("[href$='" + url + "']");
              var i = 0;
                //$(this).toggleClass("collapse expand");
                //$(this).closest('li').children('ul').slideToggle();
              $(currentItem.parents("li").get().reverse()).each(function () {
                  debugger;
                  if (i != 0) {
                    
                      var path1 = $(this).attr('value');
                    
                  }
                  if (i == 0)
                  {
                      $(".treeview li>ul").first().show();
                  }
                  i = i + 1;
              });
              debugger;
              e.preventDefault();
              var breadcrumb = [];
              var treeView = this;
                //data
              $(this).toggleClass("collapse expand");
              $(this).closest('li').children('ul').slideToggle();
              jQuery.expr[':'].casecontains = (a, b, c) => jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase()) >= 0;

            }
        });

        // Or with jQuery
        //$(".collapsible").on("click", function (e) {
        //    e.preventDefault();

        //    var this1 = $(this); // Get Click item
        //    var data = {
        //        pid: $(this).attr('pid')
        //    };

        //    var isLoaded = $(this1).attr('data-loaded'); // Check data already loaded or not
        //    if (isLoaded == "false") {
        //        $(this1).addClass("loadingP");   // Show loading panel
        //        $(this1).removeClass("collapse");

        //        // Now Load Data Here
        //        $.ajax({
        //            url: "/Menu/GetSubMenu",
        //            type: "GET",
        //            data: data,
        //            dataType: "json",
        //            success: function (d) {
        //                $(this1).removeClass("loadingP");

        //                if (d.length > 0) {

        //                    var $ul = $("<ul></ul>");
        //                    $.each(d, function (i, ele) {
        //                        $ul.append(
        //                                $("<li></li>").append(
        //                                    "<span class='collapse collapsible' data-loaded='false' pid='" + ele.MenuID + "'>&nbsp;</span>" +
        //                                    "<span><a href='" + ele.NavURL + "'>" + ele.MenuName + "</a></span>"
        //                                )
        //                            )
        //                    });

        //                    $(this1).parent().append($ul);
        //                    $(this1).addClass('collapse');
        //                    $(this1).toggleClass('collapse expand');
        //                    $(this1).closest('li').children('ul').slideDown();
        //                }
        //                else {
        //                    // no sub menu
        //                    $(this1).css({ 'dispaly': 'inline-block', 'width': '15px' });
        //                }

        //                $(this1).attr('data-loaded', true);
        //            },
        //            error: function () {
        //                alert("Error!");
        //            }
        //        });
        //    }
        //    else {
        //        // if already data loaded
        //        $(this1).toggleClass("collapse expand");
        //        $(this1).closest('li').children('ul').slideToggle();
        //    }

        //});
    });

   
</script>


